<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="css.css" />
</head>

<body onkeydown="nyom()">
    <main></main>
    <script>
        var tomb = [new Array(),new Array()];
        var ido = [new Array(),new Array()];
        ido[1].push(Date.now());
        var melyikX=1;
        var hely= [29,12];
        var kor = 0;
        ido[0]=[1666724710640, 1666724710922, 1666724713473, 1666724714385];
        tomb[0]=["ArrowLeft", "ArrowLeft", "ArrowLeft"];
        var main = document.getElementsByTagName("main")[0];
        main.style.gridTemplate = "repeat(6,100px)/repeat(6,100px)";
        main.style.height = "650px";
        main.style.width = "650px";
        main.style.maxWidth = "650px";
        main.style.maxHeight = "650px";
        for (var ix = 0; ix < 36; ix++) {
            document.getElementsByTagName("main")[0].innerHTML += "<div></div>";
        }
        var akadaly=[1,13,18,23,24,29,30,35,7];
        kiIr();

        function nyom() {
            if(event.key=="e")
                {
                    if(melyikX==1)
                        {
                            kor=0;
                            myLoop();
                            melyikX--;
                            document.getElementsByTagName("div")[hely[melyikX+1] - 1].innerHTML = "";
                            tomb[melyikX]=new Array();
                            ido[melyikX]=new Array();
                            ido[melyikX].push(Date.now());
                            hely[melyikX]=29;
                            megy(0,false);
                        }
                    else
                    {
                        kor=0;
                        myLoop();
                        melyikX++;
                        document.getElementsByTagName("div")[hely[melyikX-1] - 1].innerHTML = "";
                        tomb[melyikX]=new Array();
                        ido[melyikX]=new Array();
                        ido[melyikX].push(Date.now());
                        hely[melyikX]=12;
                        megy(0,false);
                    }

                }
            kiIr(event.key, true);
            if (hely[melyikX] == 7) {
                hely[melyikX] = 29-melyikX*17;
                megy(0, false);
                kor=0;
                myLoop();
            }
        }
        
        function kiIr(szoveg, masol){
            for (var ix = 0; ix < 36; ix++) {
                document.getElementsByTagName("div")[ix].innerHTML = "";    
            }
            for(var ix=0;ix<2;ix++)
            {
                document.getElementsByTagName("div")[hely[ix] - 1].innerHTML = 'x';
            }
            ajto();
            akadaly.forEach(a);
            irany(szoveg,masol);
        }
        function megy(mennyit, masol) {
            document.getElementsByTagName("div")[hely[melyikX] - 1].innerHTML = "";
            hely[melyikX] += mennyit;
            document.getElementsByTagName("div")[hely[melyikX] - 1].innerHTML = 'x';
            if (masol) {
                tomb[melyikX].push(event.key);
                ido[melyikX].push(Date.now());
            }
        }
        function irany(szoveg, masol) {
            if (szoveg == "ArrowUp" && hely[melyikX] > 6 &&
                document.getElementsByTagName("div")[hely[melyikX] - 7].innerHTML != "#") {
                megy(-6, masol);
            }
            else if (szoveg == "ArrowLeft" && hely[melyikX] % 6 != 1 &&
                document.getElementsByTagName("div")[hely[melyikX] - 2].innerHTML != "#") {
                megy(-1, masol);
            }
            else if (szoveg == "ArrowRight" && hely[melyikX] % 6 != 0 &&
                document.getElementsByTagName("div")[hely[melyikX]].innerHTML != "#") {
                megy(1, masol);
            }
            else if (szoveg == "ArrowDown" && hely[melyikX] <= 30 &&
                document.getElementsByTagName("div")[hely[melyikX] + 5].innerHTML != "#") {
                megy(6, masol);
            }
        }

        function myLoop() {
            setTimeout(function () {
                kiIr(tomb[melyikX][kor], false);
                kor++;
                if (kor < tomb[melyikX].length) {
                    myLoop();
                }
            }, ido[melyikX][kor + 1] - ido[melyikX][kor])
        }

        function ajto() {
            if (document.getElementsByTagName("div")[10].innerHTML == "x")
                {
                    var value = 7

                    

                    akadaly = akadaly.filter(function(item) {
                        return item !== value
                    })

                }
            else
                akadaly.push(7);
        }
        function a(item,index)
        {
            document.getElementsByTagName("div")[item].innerHTML = "#";
        }
    </script>
    <script type="module">
        import myJson from "./example.json" assert { type: "json" };
        console.log(myJson.level.ido);
    </script>
</body>

</html>